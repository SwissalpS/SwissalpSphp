<?php/* * * * * * SssS_ChatClient.inc * * * * @version 20091030_130502 (CC) Luke JZ aka SwissalpS * * * */class SssS_ChatClient extends SssS_PlistPrefs {	protected $rSpawn = null; // users socket resource	var $oDelegate = null; // the delegate server the user is attached to or permitted to	var $bSave2disk = false; // should we save at all?	var $aLastPHPresults = array();	var $oSandBox = null;	var $oShellPHP = null;	var $sStackIn = '';	function SssS_ChatClient($sPath = '', $oDelegate = null,			$bPathCheckCreate = true) {		$this->SssS_PlistPrefs($sPath, false, true, $bPathCheckCreate);		$this->oDelegate = $oDelegate;		$this->getOrSet('uid', 'Unidentified');		$this->getOrSet('name', 'Unnamed');		$this->aPermissions = $this->getOrSet('permissions', array('lobby' => 7));	} // SssS_ChatClient	function dropBox($sMsg) {		$iCount = count($this->get('stacks/dropbox'));		$this->set('stacks/dropbox/' . $iCount,				htmlspecialchars($sMsg, ENT_COMPAT, 'utf-8'));		return $this->save();	} // dropBox	function flushHistory($bSave = true) {		$this->set('stacks/dropbox', array());		if ($bSave) return $this->save();		return true;	} // flushHistory	function isConnected() {		return (null !== $this->rSpawn);	} // isConnected	function logout() {		if (!$this->oDelegate)				return "\n" . 'can\'t logout, have no delegate' . "\n" . '105';		if (!$this->isConnected())				return "\n" . 'can\'t logout, am not connected' . "\n" . '102';		return $this->oDelegate->kickUser($this->uid());	} // logout	function name() {		return $this->get('name');	} // name	function resourceHandle() {		return $this->rSpawn;	} // resourceHandle	// override default behaviour	function save() {		if ($this->getOrSet('flushHistoryOnExit', true))				$this->flushHistory(false);		// if we can save to disk we do so		if ($this->getOrSet('save2disk', false)) return parent::save();		// otherwise only free up some memory		return $this->freeMemory();		return false;	} // save	function setResourceHandle($rH = null) {		if ('resource' != gettype($rH)) $rH = null;		$this->rSpawn = $rH;		return true;	} // setResourceHandle	function uid() {		return $this->get('uid');	} // uid} // SssS_ChatClient/* * * *\ SssS_ChatClient.inc (CC) Luke JZ aka SwissalpS /* * * */?>